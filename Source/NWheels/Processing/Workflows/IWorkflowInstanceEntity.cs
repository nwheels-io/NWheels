using System;
using NWheels.DataObjects;
using NWheels.Entities;
using NWheels.Processing.Core;
using NWheels.Processing.Workflows.Core;

namespace NWheels.Processing.Workflows
{
    [EntityContract]
    public interface IWorkflowInstanceEntity
    {
        Guid WorkflowInstanceId { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        Guid CorrelationId { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        WorkflowState WorkflowState { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        DateTime CreatedAtUtc { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        DateTime UpdatedAtUtc { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        DateTime TimeoutAtUtc { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        [PropertyContract.Required, PropertyContract.Semantic.InheritorOf(typeof(IWorkflowCodeBehind))]
        Type CodeBehindClrType { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        byte[] ProcessorSnapshot { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        TimeSpan TotalTime { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        TimeSpan TotalExecutionTime { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        TimeSpan TotalSuspensionTime { get; set; }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------

        int TotalSuspensionCount { get; set; }
    }

    //---------------------------------------------------------------------------------------------------------------------------------------------------------

    [EntityContract]
    public interface IStateMachineInstanceEntity<TState> : IWorkflowInstanceEntity
    {
        [PropertyContract.Required]
        TState MachineState { get; set; }
    }
}
